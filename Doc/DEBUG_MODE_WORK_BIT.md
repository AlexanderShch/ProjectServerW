# Режим отладки - Отключение проверки бита Work

## ?? ВРЕМЕННАЯ НАСТРОЙКА ДЛЯ ОТЛАДКИ

## Что изменено

В файле `DataForm.cpp` (строки 418-422) **временно отключена** проверка бита Work.

### Было (рабочий режим):
```cpp
// Добавление строки в таблицу только во время работы дефростера
if (workBitDetected)
{
    table->Rows->Add(row);
}
```

### Стало (режим отладки):
```cpp
// Добавление строки в таблицу только во время работы дефростера
// ВРЕМЕННО ОТКЛЮЧЕНО ДЛЯ ОТЛАДКИ - данные записываются всегда
//if (workBitDetected)
//{
    table->Rows->Add(row);
//}
```

## Что это означает

### Рабочий режим (с проверкой):
- Данные записываются в таблицу ТОЛЬКО когда бит Work = 1
- Когда дефростер не работает (Work = 0), данные не сохраняются
- Автоматический старт записи при включении дефростера
- Автоматический стоп записи через 60 секунд после выключения

### Режим отладки (без проверки):
- ? Данные записываются **ВСЕГДА**, независимо от бита Work
- ? Можно тестировать запись без запуска дефростера
- ? Все телеметрические данные попадают в таблицу
- ?? Файлы могут быть очень большими
- ?? Логика автоматического старта/стопа продолжает работать

## Как вернуть обратно (после отладки)

Раскомментируйте проверку в `DataForm.cpp` (строки 418-422):

```cpp
// Добавление строки в таблицу только во время работы дефростера
if (workBitDetected)
{
    table->Rows->Add(row);
}
```

Удалите строки:
```cpp
// ВРЕМЕННО ОТКЛЮЧЕНО ДЛЯ ОТЛАДКИ - данные записываются всегда
//if (workBitDetected)
//{
    table->Rows->Add(row);
//}
```

## Компиляция

После изменения перекомпилируйте проект:
```
Build ? Rebuild Solution
```

## Использование

### В режиме отладки:
1. Запустите программу
2. Подключитесь к контроллеру
3. Данные будут автоматически появляться в таблице
4. Нажмите кнопку "EXCEL" для сохранения в любое время
5. Проверьте лог для времени записи

### Что проверять:
- ? Все строки добавляются в таблицу
- ? Данные корректны
- ? Запись в Excel работает быстро
- ? График температур создается
- ? Время записи логируется

## Рекомендации

1. **Для тестирования оптимизации Excel:** Используйте режим отладки
2. **Для реальной работы:** Верните проверку бита Work
3. **Контролируйте размер файлов:** В режиме отладки они растут быстро

## Файлы

- Измененный файл: `DataForm.cpp` (метод `AddDataToTableThreadSafe`)
- Строки: 418-422

---

**Не забудьте вернуть проверку после завершения отладки!**

